# see domain-specific .yml for documentation
wu:
  image: systemapic/wu:latest
  environment:
    SYSTEMAPIC_DOMAIN: ${SYSTEMAPIC_DOMAIN}
    SYSTEMAPIC_PRODMODE: 'true'
  working_dir: /systemapic/prod # todo: remove (currently needed for doing `docker run ... grunt test`, but can be fixed with `./test.sh` script, or something better)
  volumes:
    - /docks/modules/wu:/systemapic/dev 
    - /docks/config/${SYSTEMAPIC_DOMAIN}:/systemapic/config

pile: 
  image: systemapic/pile:latest
  environment:
    SYSTEMAPIC_DOMAIN: ${SYSTEMAPIC_DOMAIN}
    SYSTEMAPIC_PRODMODE: 'true'
  volumes:
    - /docks/config/${SYSTEMAPIC_DOMAIN}:/systemapic/config
    - /docks/modules/pile:/systemapic/dev

nginx:
  image: systemapic/nginx:latest
  ports:
    - 443:443
    - 80:80
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config

redis:
  image: redis:latest
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config

mongo: 
  image: systemapic/mongo:latest
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config

postgis:
  image: systemapic/postgis:latest
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config
  command: ./start.sh

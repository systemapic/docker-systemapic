wu:
  image: systemapic/wu:latest
  links:
    - mongo
    - redislayers
    - redisstats
    - redistemp
    - redistokens
    - postgis
  environment:
    - SYSTEMAPIC_DOMAIN=${SYSTEMAPIC_DOMAIN}
    - SYSTEMAPIC_PRODMODE=false
  volumes_from:
    - data_store_dev_common
  volumes: 
    - /docks/config/dev.systemapic.com:/systemapic/config
    # - /docks/modules/wu:/var/www/wu     # add these to lines to do local edits (from /docks/modules/wu/)
  # command: ./server.sh

pile: 
  image: systemapic/pile:latest
  links: 
    - wu
    - mongo
    - redislayers
    - redisstats
    - redistokens
    - redistemp
    - postgis
  volumes_from:
    - data_store_dev_common
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config
    # - /var/www/pile:/var/www/pile 
  # command: ./pile-server.sh

nginx:
  image: systemapic/nginx:latest
  links: 
    - pile
    - wu
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config
  ports:
    - 443:443
    - 80:80

postgis:
  image: systemapic/postgis:latest
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config
  volumes_from:
    - postgis_store_dev
  command: ./start.sh

redislayers:
  image: systemapic/redis:layers
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config
  volumes_from:
    - redis_store_dev

redisstats:
  image: systemapic/redis:stats
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config
  volumes_from:
    - redis_stats_store_dev

redistemp:
  image: systemapic/redis:kue
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config

redistokens:
  image: systemapic/redis:tokens
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config
  volumes_from:
    - store_dev_redis_tokens

mongo: 
  image: systemapic/mongo:latest
  volumes:
    - /docks/config/dev.systemapic.com:/systemapic/config
  volumes_from:
    - mongo_store_dev
